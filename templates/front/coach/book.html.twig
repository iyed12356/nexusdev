{% extends 'base.html.twig' %}

{% block title %}Book Session with {{ coach.user.username }}{% endblock %}

{% block body %}
<div class="np-section">
    <div class="np-section-header">
        <span class="np-section-kicker">Book a Coaching Session</span>
        <h1 class="np-section-title">Schedule with {{ coach.user.username }}</h1>
        <p class="np-section-subtitle">Fill in the details below to request your coaching session.</p>
    </div>

    <div class="row">
        <div class="col-md-8">
            <div class="np-form-card">
                <h3 class="m-0 mb-3">Session Details</h3>
                
                {{ form_start(form, {'attr': {'class': 'np-form'}}) }}
                    <div class="form-group">
                        {{ form_label(form.scheduledAt, null, {'label_attr': {'class': 'form-label'}}) }}
                        <div class="datetime-picker-wrapper">
                            {{ form_widget(form.scheduledAt, {'attr': {
                                'class': 'form-control datetime-picker',
                                'type': 'datetime-local',
                                'min': '+1 hour'|date('Y-m-d\TH:i')
                            }}) }}
                        </div>
                        {% if form.scheduledAt.vars.help %}
                            <small class="text-muted d-block mt-1">{{ form.scheduledAt.vars.help }}</small>
                        {% endif %}
                        {{ form_errors(form.scheduledAt) }}
                    </div>
                    
                    <div class="form-group">
                        {{ form_label(form.notes, null, {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.notes, {'attr': {'class': 'form-control', 'rows': '4'}}) }}
                        {{ form_errors(form.notes) }}
                    </div>
                    
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">
                            Send Request
                        </button>
                        <a href="{{ path('front_coach_index') }}" class="btn btn-secondary">
                            Cancel
                        </a>
                    </div>
                {{ form_end(form) }}
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="np-card mb-3">
                <h4 class="m-0 mb-3">Coach Info</h4>
                <div class="d-flex align-items-center gap-3 mb-3">
                    {% if coach.user.profilePicture %}
                        <img src="{{ asset('uploads/' ~ coach.user.profilePicture) }}" alt="{{ coach.user.username }}" class="np-avatar np-avatar--md">
                    {% else %}
                        <div class="np-avatar np-avatar--md">{{ coach.user.username|first|upper }}</div>
                    {% endif %}
                    <div>
                        <div class="font-weight-semibold">{{ coach.user.username }}</div>
                        <div class="np-rating">â˜… {{ coach.rating|default('0.0') }}</div>
                    </div>
                </div>
                <p class="text-muted mb-3" style="font-size: 0.9rem;">
                    {{ coach.bio|default('Experienced coach ready to help you improve.') }}
                </p>
                <div class="d-flex justify-content-between align-items-center pt-3" style="border-top: 1px solid rgba(255,255,255,0.1);">
                    <span class="text-muted">Price</span>
                    <span class="np-price">
                        {% if coach.pricePerSession %}{{ coach.pricePerSession }}{% else %}Free{% endif %}
                        <span class="np-price__currency">{% if coach.pricePerSession %}VC{% endif %}</span>
                    </span>
                </div>
            </div>
            
            <div class="np-card">
                <h4 class="m-0 mb-3">Your Info</h4>
                <div class="d-flex align-items-center gap-3">
                    {% if player.profilePicture %}
                        <img src="{{ asset('uploads/' ~ player.profilePicture) }}" alt="{{ player.nickname }}" class="np-avatar np-avatar--sm">
                    {% else %}
                        <div class="np-avatar np-avatar--sm">{{ player.nickname|first|upper }}</div>
                    {% endif %}
                    <div>
                        <div class="font-weight-semibold">{{ player.nickname }}</div>
                        <div class="text-muted" style="font-size: 0.85rem;">{{ player.game.name }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.datetime-picker-wrapper input[type="datetime-local"] {
    background: #05070b;
    border: 1px solid rgba(255,255,255,0.1);
    color: #fff;
    padding: 0.75rem;
    border-radius: 10px;
    width: 100%;
    font-size: 1rem;
    cursor: pointer;
}

.datetime-picker-wrapper input[type="datetime-local"]::-webkit-calendar-picker-indicator {
    filter: invert(1);
    cursor: pointer;
    opacity: 0.7;
}

.datetime-picker-wrapper input[type="datetime-local"]::-webkit-calendar-picker-indicator:hover {
    opacity: 1;
}
</style>
{% endblock %}
