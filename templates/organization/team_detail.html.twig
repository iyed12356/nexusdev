{% extends 'base_organization.html.twig' %}

{% block title %}{{ team.name }} - Team Details{% endblock %}

{% block body %}
    {# Hero Banner #}
    <div style="background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 30%, #0f172a 70%, #1e1b4b 100%); padding: 3rem 0 2rem; margin-bottom: 0; position: relative; overflow: hidden;">
        {# Background Pattern #}
        <div style="position: absolute; inset: 0; opacity: 0.03; background-image: radial-gradient(circle at 2px 2px, white 1px, transparent 0); background-size: 40px 40px;"></div>
        
        <div class="container-fluid px-4" style="position: relative; z-index: 1;">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <div class="d-flex align-items-center gap-4">
                        {# Team Logo #}
                        <div style="width: 120px; height: 120px; border-radius: 24px; background: linear-gradient(135deg, rgba(99,102,241,0.3) 0%, rgba(139,92,246,0.3) 100%); display: flex; align-items: center; justify-content: center; border: 2px solid rgba(99,102,241,0.5); box-shadow: 0 20px 60px rgba(99,102,241,0.3), inset 0 0 60px rgba(99,102,241,0.1);">
                            {% if team.logo %}
                                <img src="{{ asset('uploads/logos/' ~ team.logo) }}" alt="{{ team.name }}" style="width: 90px; height: 90px; border-radius: 16px; object-fit: cover;">
                            {% else %}
                                <span style="font-size: 3.5rem; font-weight: 800; color: #6366f1; text-shadow: 0 0 30px rgba(99,102,241,0.5);">{{ team.name|first|upper }}</span>
                            {% endif %}
                        </div>
                        
                        {# Team Info #}
                        <div>
                            <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 3px; color: #818cf8; margin-bottom: 0.5rem; font-weight: 600;">Professional Esports Team</div>
                            <h1 style="font-size: 3rem; font-weight: 800; margin: 0; color: #fff; letter-spacing: -1px;">{{ team.name }}</h1>
                            <div class="d-flex flex-wrap align-items-center gap-3 mt-3" style="font-size: 0.95rem; color: #94a3b8;">
                                <span class="d-flex align-items-center gap-1">
                                    <svg width="14" height="14" fill="#60a5fa" viewBox="0 0 16 16"><path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z"/><path d="M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/></svg>
                                    {{ team.country|default('Global') }}
                                </span>
                                <span style="color: #475569;">|</span>
                                <span class="d-flex align-items-center gap-1">
                                    <svg width="14" height="14" fill="#a78bfa" viewBox="0 0 16 16"><path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/><path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/></svg>
                                    {{ team.game.name|default('Multi-Game') }}
                                </span>
                                {% if team.foundationYear %}
                                    <span style="color: #475569;">|</span>
                                    <span>Est. {{ team.foundationYear }}</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 text-md-end mt-4 mt-md-0">
                    <a href="{{ path('app_organization_back', {'view': 'teams'}) }}" class="btn btn-outline-light" style="border-radius: 12px; padding: 0.75rem 1.5rem;">
                        <svg width="18" height="18" fill="currentColor" class="me-2" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/></svg>
                        All Teams
                    </a>
                </div>
            </div>
        </div>
    </div>

    {# Stats Bar #}
    <div style="background: rgba(15,23,42,0.95); border-bottom: 1px solid rgba(255,255,255,0.05); padding: 2rem 0;">
        <div class="container-fluid px-4">
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem;">
                <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem;">
                    <div style="width: 56px; height: 56px; border-radius: 16px; background: linear-gradient(135deg, rgba(99,102,241,0.2) 0%, rgba(99,102,241,0.1) 100%); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <svg width="28" height="28" fill="#818cf8" viewBox="0 0 16 16"><path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/><path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/><path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/></svg>
                    </div>
                    <div>
                        <div style="font-size: 2rem; font-weight: 800; color: #fff; line-height: 1;">{{ stats.playerCount }}</div>
                        <div style="font-size: 0.8rem; color: #64748b; text-transform: uppercase; letter-spacing: 1px;">Players</div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem;">
                    <div style="width: 56px; height: 56px; border-radius: 16px; background: linear-gradient(135deg, rgba(59,130,246,0.2) 0%, rgba(59,130,246,0.1) 100%); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <svg width="28" height="28" fill="#60a5fa" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/></svg>
                    </div>
                    <div>
                        <div style="font-size: 2rem; font-weight: 800; color: #fff; line-height: 1;">{{ stats.totalMatches }}</div>
                        <div style="font-size: 0.8rem; color: #64748b; text-transform: uppercase; letter-spacing: 1px;">Matches</div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem;">
                    <div style="width: 56px; height: 56px; border-radius: 16px; background: linear-gradient(135deg, rgba(16,185,129,0.2) 0%, rgba(16,185,129,0.1) 100%); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <svg width="28" height="28" fill="#34d399" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/></svg>
                    </div>
                    <div>
                        <div style="font-size: 2rem; font-weight: 800; color: #10b981; line-height: 1;">{{ stats.winRate }}%</div>
                        <div style="font-size: 0.8rem; color: #64748b; text-transform: uppercase; letter-spacing: 1px;">Win Rate</div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem;">
                    <div style="width: 56px; height: 56px; border-radius: 16px; background: linear-gradient(135deg, rgba(139,92,246,0.2) 0%, rgba(139,92,246,0.1) 100%); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <svg width="28" height="28" fill="#a78bfa" viewBox="0 0 16 16"><path d="M0 0h1v15h15v1H0V0Zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.3 3.3a.5.5 0 0 1-.708 0L7 6.707l-3.3 3.3a.5.5 0 0 1-.708 0l-1.1-1.1a.5.5 0 0 1 0-.708l3.3-3.3a.5.5 0 0 1 .708 0L9 5.293l3.3-3.3a.5.5 0 0 1 .7 0V3.5Z"/></svg>
                    </div>
                    <div>
                        <div style="font-size: 2rem; font-weight: 800; color: #8b5cf6; line-height: 1;">{{ stats.kdRatio }}</div>
                        <div style="font-size: 0.8rem; color: #64748b; text-transform: uppercase; letter-spacing: 1px;">K/D Ratio</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {# Main Content #}
    <div class="container-fluid px-4 py-4">
        <div class="row g-4">
            {# Player Roster #}
            <div class="col-lg-8">
                <div style="background: rgba(30,41,59,0.4); border: 1px solid rgba(255,255,255,0.05); border-radius: 24px; overflow: hidden;">
                    {# Header #}
                    <div class="p-4" style="background: linear-gradient(90deg, rgba(99,102,241,0.1) 0%, transparent 100%); border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center gap-3">
                                <div style="width: 48px; height: 48px; border-radius: 12px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); display: flex; align-items: center; justify-content: center;">
                                    <svg width="24" height="24" fill="white" viewBox="0 0 16 16"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/></svg>
                                </div>
                                <div>
                                    <h4 class="mb-0" style="font-weight: 700; color: #fff;">Player Roster</h4>
                                    <p class="mb-0" style="color: #64748b; font-size: 0.875rem;">{{ players|length }} active members</p>
                                </div>
                            </div>
                            <a href="{{ path('app_organization_back', {'view': 'players'}) }}" class="btn btn-success" style="border-radius: 10px; padding: 0.625rem 1.25rem;">
                                <svg width="18" height="18" fill="currentColor" class="me-1" viewBox="0 0 16 16"><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/></svg>
                                Recruit
                            </a>
                        </div>
                    </div>

                    {# Players Grid #}
                    <div class="p-4">
                        {% if players is empty %}
                            <div class="text-center py-5">
                                <div style="width: 80px; height: 80px; background: rgba(99,102,241,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
                                    <svg width="40" height="40" fill="#6366f1" viewBox="0 0 16 16"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/></svg>
                                </div>
                                <h5 style="color: #94a3b8; font-weight: 600;">No Players Yet</h5>
                                <p class="mb-3" style="color: #64748b; max-width: 300px; margin-left: auto; margin-right: auto;">Build your dream team by recruiting professional players.</p>
                                <a href="{{ path('app_organization_back', {'view': 'players'}) }}" class="btn btn-primary" style="border-radius: 10px;">Browse Players</a>
                            </div>
                        {% else %}
                            <div class="row g-3">
                                {% for player in players %}
                                    <div class="col-md-6">
                                        <div class="player-card" style="background: rgba(15,23,42,0.6); border: 1px solid rgba(255,255,255,0.05); border-radius: 16px; padding: 1.25rem; transition: all 0.2s;">
                                            <div class="d-flex align-items-center gap-3">
                                                {# Avatar #}
                                                <div style="position: relative; flex-shrink: 0;">
                                                    {% if player.profilePicture %}
                                                        <img src="{{ asset('uploads/' ~ player.profilePicture) }}" alt="{{ player.nickname }}" class="rounded-circle" style="width: 64px; height: 64px; object-fit: cover; border: 2px solid rgba(99,102,241,0.5);">
                                                    {% else %}
                                                        <div class="rounded-circle d-flex align-items-center justify-content-center" style="width: 64px; height: 64px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); font-size: 1.75rem; font-weight: 700; color: white;">
                                                            {{ player.nickname|first|upper }}
                                                        </div>
                                                    {% endif %}
                                                    {% if player.isPro %}
                                                        <span class="badge" style="position: absolute; bottom: -2px; right: -2px; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: #000; font-size: 0.65rem; padding: 2px 6px; border-radius: 20px; font-weight: 700;">PRO</span>
                                                    {% endif %}
                                                </div>
                                                
                                                {# Info #}
                                                <div class="flex-grow-1" style="min-width: 0;">
                                                    <div class="d-flex align-items-center gap-2 mb-1">
                                                        <h6 class="mb-0" style="font-weight: 700; color: #fff; font-size: 1.1rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{ player.nickname }}</h6>
                                                    </div>
                                                    <div class="d-flex align-items-center gap-2 mb-1">
                                                        <span class="badge" style="background: rgba(99,102,241,0.2); color: #818cf8; font-size: 0.7rem; padding: 3px 8px; border-radius: 6px;">{{ player.getRank() }}</span>
                                                        <span style="font-size: 0.8rem; color: #64748b;">{{ player.score }} pts</span>
                                                    </div>
                                                    <div style="font-size: 0.8rem; color: #64748b; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                                        {{ player.role|default('No role') }} â€¢ {{ player.game.name|default('No game') }}
                                                    </div>
                                                </div>
                                                
                                                {# Actions #}
                                                <div style="flex-shrink: 0;">
                                                    <form method="post" action="{{ path('app_organization_release_player', {'playerId': player.id}) }}" onsubmit="return confirm('Release {{ player.nickname }}?');">
                                                        <input type="hidden" name="_token" value="{{ csrf_token('release' ~ player.id) }}">
                                                        <button type="submit" class="btn btn-sm btn-outline-danger" style="border-radius: 8px; padding: 0.375rem 0.75rem;">
                                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            {# Sidebar #}
            <div class="col-lg-4">
                {# About Card #}
                <div class="mb-4" style="background: rgba(30,41,59,0.4); border: 1px solid rgba(255,255,255,0.05); border-radius: 24px; overflow: hidden;">
                    <div class="p-4" style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <h5 class="mb-0" style="font-weight: 700; color: #fff;">About Team</h5>
                    </div>
                    <div class="p-4">
                        {% if team.description %}
                            <p style="color: #94a3b8; font-size: 0.9rem; line-height: 1.7; margin-bottom: 1.5rem;">{{ team.description }}</p>
                        {% else %}
                            <p style="color: #64748b; font-size: 0.9rem; font-style: italic; margin-bottom: 1.5rem;">No description provided.</p>
                        {% endif %}
                        
                        <div style="background: rgba(15,23,42,0.5); border-radius: 12px; padding: 1rem;">
                            <div class="mb-3">
                                <div style="font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; color: #64748b; margin-bottom: 0.25rem;">Organization</div>
                                <div style="font-weight: 600; color: #fff;">{{ organization.name|default('Independent') }}</div>
                            </div>
                            <div class="mb-3">
                                <div style="font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; color: #64748b; margin-bottom: 0.25rem;">Game</div>
                                <div style="font-weight: 600; color: #fff;">{{ team.game.name|default('Not specified') }}</div>
                            </div>
                            <div class="mb-0">
                                <div style="font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; color: #64748b; margin-bottom: 0.25rem;">Country</div>
                                <div style="font-weight: 600; color: #fff;">{{ team.country|default('Not specified') }}</div>
                            </div>
                        </div>
                    </div>
                </div>

                {# Actions Card #}
                <div style="background: rgba(30,41,59,0.4); border: 1px solid rgba(255,255,255,0.05); border-radius: 24px; overflow: hidden;">
                    <div class="p-4" style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <h5 class="mb-0" style="font-weight: 700; color: #fff;">Quick Actions</h5>
                    </div>
                    <div class="p-4">
                        <a href="{{ path('app_organization_back', {'view': 'players'}) }}" class="btn btn-outline-primary w-100 mb-3 d-flex align-items-center justify-content-center gap-2" style="border-radius: 12px; padding: 0.75rem;">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/></svg>
                            Find Players
                        </a>
                        <a href="{{ path('app_organization_back', {'view': 'dashboard'}) }}" class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-center gap-2" style="border-radius: 12px; padding: 0.75rem;">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M8 4a.5.5 0 0 1 .5.5V6a.5.5 0 0 1-1 0V4.5A.5.5 0 0 1 8 4zm0 8a.5.5 0 0 1 .5.5V14a.5.5 0 0 1-1 0v-1.5A.5.5 0 0 1 8 12zM8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/></svg>
                            Dashboard
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        .player-card:hover {
            border-color: rgba(99,102,241,0.3) !important;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        /* Override max-width for full screen layout */
        .np-main {
            max-width: none !important;
            width: 100%;
        }
    </style>
{% endblock %}
